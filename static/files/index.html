<html>

<head>
	<title>{{ state.Stats ? state.Stats.Title : 'Cloud Torrent' }}</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<link rel="stylesheet" type="text/css" href="css/Lato/Lato.css">
	<link rel="stylesheet" type="text/css" href="css/semantic.min.css">
	<link rel="stylesheet" type="text/css" href="css/app.css">
	<link rel="icon" href="cloud-favicon.png" type="image/x-icon" />
	<style type="text/css">
		[v-cloak] {
			display: none;
		}
	</style>
</head>

<body class="app">
	<div id="app">
		<div v-cloak class="cage" @drop="uploadTorrent" @dragover.prevent @dragenter.prevent>
			<div v-if="!connected" class="connect-warning ui inverted vertical masthead center aligned segment">
				<div class="ui text container">
					<h1 class="ui inverted header">
						{{ hasConnected ? 'Disconnected' : 'Connecting' }}
					</h1>
					<h1 class="ui inverted header">
						<i class="red lightning icon"></i>
					</h1>
				</div>
			</div>
			<!-- TITLE ===================== -->
			<div class="title">
				<h2>
					<a href="https://github.com/jpillora/cloud-torrent" target="_blank" 
					 @mouseover="logoHover = true" @mouseleave="logoHover = false">
						<i class="blue icon" :class="{cloud:!logoHover, github: logoHover}"></i> {{ state.Stats ? state.Stats.Title : 'Cloud Torrent' }}
					</a>
				</h2>
				<div class="status">
					<i v-show="apiing || searching" class="ui circular loading repeat icon"></i>
					<i @click="config.edit = !config.edit" :class="{green: config.edit}"
					 class="ui circular server icon" style="font-size: 14px;"></i>
					<i @click="omni.edit = !omni.edit" :class="{green: omni.edit}" class="ui circular magnet icon"
					 style="font-size: 14px;"></i>
					<i class="ui circular lightning icon" :class="{ green: connected, red: !connected }"></i>
				</div>
			</div>
			<!-- GLOBAL ERROR MESSAGE ===================== -->
			<div v-if="err" class="ui error message">
				<i class="close icon" @click="err = null"></i>
				<div class="header">Error</div>
				<p>{{err}}</p>
			</div>

				<config-section :state="state" :config="config" :apiing="apiing" @submit-config="submitConfig"></config-section>
			<omni-section :state="state" :omni="omni" :apiing="apiing" :searching="searching" @submit-omni="submitOmni" @submit-search="submitSearch" @submit-search-item="submitSearchItem" @parse-omni="parseOmniInput"></omni-section>
			<torrents-section :state="state" :torrents="torrents" @submit-torrent="submitTorrent" @submit-file="submitFile"></torrents-section>
			<downloads-section :state="state" :downloads="downloads"></downloads-section>

			<footer>
				<div>
					<span>github.com/
						<a href="https://github.com/jpillora" target="_blank">jpillora</a>/
						<a href="https://github.com/jpillora/cloud-torrent" target="_blank">cloud-torrent</a> version {{ state.Stats ? state.Stats.Version : '' }} - </span>
					<span v-if="state.Users && numKeys(state.Users) > 1">{{ numKeys(state.Users) }} users connected - </span>
					<span>
						<a href="https://golang.org" target="_blank">Go</a> {{ state.Stats ? state.Stats.Runtime : '' }}
					</span>
				</div>
				<div>
					<span v-if="state.Stats && state.Stats.System && state.Stats.System.set">
						<span class="extra">
							goroutines {{ state.Stats.System.goRoutines }},
						</span>
						<span class="extra">
							gomem {{ formatBytes(state.Stats.System.goMemory) }},
						</span>
						<span>
							cpu {{ Math.round(state.Stats.System.cpu * 10) / 10 }}%,
						</span>
						<span>
							mem {{ Math.round(100*state.Stats.System.memoryUsed/state.Stats.System.memoryTotal * 10) / 10 }}%,
						</span>
						<span>
							disk {{ Math.round(100*state.Stats.System.diskUsed/state.Stats.System.diskTotal * 10) / 10 }}%,
						</span>
					</span>
					<span v-if="state.Stats && state.Stats.Uptime">up {{ ago(state.Stats.Uptime) }}</span>
				</div>
			</footer>
		</div>

		<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
		<script src="js/velox.js"></script>
		<script src="js/run.js"></script>
	</div>
</body>

</html>